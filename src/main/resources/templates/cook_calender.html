<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="'Calendar - ' + ${cook.cookName}"></title>
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>
        .day-card { min-height: 180px; }
        .slot-btn { margin: 3px 0; width: 100%; font-size: 0.8rem; }
        .booked { background-color: #b0b0b0 !important; color: white; }
        .available { background-color: #28a745 !important; color: white; }
        .selected { background-color: #007bff !important; color: white; }
    </style>
</head>
<body class="bg-light">
<div class="container mt-4">
    <h2 class="mb-3 text-center" th:text="'Booking Calendar for ' + ${cook.cookName}"></h2>

    <div class="alert alert-light text-center mb-3">
        <span class="badge bg-success">Available</span>
        <span class="badge bg-secondary">Booked</span>
        <span class="badge bg-primary">Selected</span>
    </div>

    <div class="row row-cols-1 row-cols-md-4 g-3">
        <div th:each="entry : ${slotsByDate}">
            <div class="col">
                <div class="card day-card shadow-sm">
                    <div class="card-header text-center bg-primary text-white">
                        <span th:text="${#temporals.format(entry.key, 'MMM dd, EEE')}"></span>
                    </div>
                    <div class="card-body">
                        <div th:each="slot : ${entry.value}">
                            <a th:href="@{'/home/book/form'(cookId=${cook.cookId}, slotId=${slot.id})}"
                            class="btn btn-sm slot-btn"
                            th:classappend="${slot.booked} ? 'booked' : (${slot.id} == ${selectedSlotId} ? 'selected' : 'available')"
                            th:text="${#temporals.format(slot.startTime, 'hh:mm a')} + ' - ' + ${#temporals.format(slot.endTime, 'hh:mm a')}">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:if="${success}" class="alert alert-success mt-3" th:text="${success}"></div>
    <div th:if="${error}" class="alert alert-danger mt-3" th:text="${error}"></div>
</div>

<script>
    setTimeout(() => {
        document.querySelectorAll('.selected').forEach(btn => {
            btn.classList.remove('selected');
            btn.classList.add('booked');
        });
    }, 4000);
</script>
</body>
</html>
